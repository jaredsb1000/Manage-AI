<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Manage AI | Neural Sourcing & Trading</title>
    <style>
        /* --- CORE & VARIABLES --- */
        :root {
            --bg-deep: #050505;
            --bg-glass: rgba(20, 20, 20, 0.7);
            --bg-card: #111111;
            --bg-card-hover: #1f1f1f;
            --accent: #00f3ff;
            --accent-glow: rgba(0, 243, 255, 0.4);
            --success: #00ff41;
            --danger: #ff4d4d;
            --trade: #ffa500; /* Orange for Trading */
            --text-main: #ffffff;
            --text-dim: #888888;
            --border: #333333;
            --font-mono: 'Courier New', monospace;
            --font-ui: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
        }

        * { box-sizing: border-box; outline: none; }

        body {
            background-color: var(--bg-deep);
            color: var(--text-main);
            font-family: var(--font-ui);
            overflow-x: hidden;
            cursor: default;
        }

        /* --- UI ELEMENTS --- */
        #scroll-progress {
            position: fixed; top: 0; left: 0; height: 3px; background: var(--accent); width: 0%; z-index: 9999; transition: width 0.1s;
        }

        /* --- PARTICLES --- */
        #particle-canvas {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            z-index: -1; opacity: 0.3; pointer-events: none;
        }

        /* --- NAV --- */
        nav {
            position: sticky; top: 0; z-index: 100;
            display: flex; justify-content: space-between; align-items: center;
            padding: 20px 40px;
            background: var(--bg-glass);
            backdrop-filter: blur(12px);
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .brand {
            font-family: var(--font-mono); font-size: 1.5rem; font-weight: 800;
            color: #fff; letter-spacing: -1px; text-transform: uppercase; cursor: pointer;
            text-shadow: 0 0 10px var(--accent-glow);
        }
        .brand:hover { animation: glitch 0.3s cubic-bezier(.25, .46, .45, .94) both infinite; }
        @keyframes glitch {
            0% { transform: translate(0) } 20% { transform: translate(-2px, 2px) } 40% { transform: translate(-2px, -2px) }
            60% { transform: translate(2px, 2px) } 80% { transform: translate(2px, -2px) } 100% { transform: translate(0) }
        }

        .nav-controls { display: flex; gap: 15px; align-items: center; }

        .nav-btn {
            background: transparent; border: 1px solid rgba(255,255,255,0.2);
            color: #fff; padding: 10px 20px; border-radius: 4px; cursor: pointer; font-family: var(--font-mono); font-size: 0.8rem; transition: 0.3s;
        }
        .nav-btn:hover, .nav-btn.active { background: var(--accent); color: #000; box-shadow: 0 0 15px var(--accent-glow); }

        /* --- REELS --- */
        .reels-container {
            display: flex; overflow-x: auto; gap: 25px; padding: 40px 0;
            scroll-behavior: smooth; margin-bottom: 60px;
        }
        .reels-container::-webkit-scrollbar { height: 8px; }
        .reels-container::-webkit-scrollbar-thumb { background: var(--accent); border-radius: 4px; }
        
        .reel-card {
            flex: 0 0 280px; height: 350px; background: var(--bg-card);
            border-radius: 12px; overflow: hidden; position: relative;
            border: 1px solid var(--border); transition: all 0.4s ease; cursor: pointer;
        }
        .reel-card:hover { transform: translateY(-10px); border-color: var(--accent); box-shadow: 0 20px 40px rgba(0,0,0,0.5); }
        .reel-img { width: 100%; height: 100%; object-fit: cover; transition: 0.4s; }
        .reel-card:hover .reel-img { transform: scale(1.05); }

        /* --- SHOP GRID --- */
        .container { max-width: 1200px; margin: 0 auto; padding: 0 20px 80px 20px; }
        .section-header {
            display: flex; justify-content: space-between; align-items: center;
            margin-bottom: 30px; border-bottom: 1px solid rgba(255,255,255,0.1); padding-bottom: 10px;
        }
        .section-title { color: var(--text-dim); font-family: var(--font-mono); text-transform: uppercase; letter-spacing: 2px; font-size: 0.9rem; }

        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 30px; }
        
        .card {
            background: var(--bg-card); border-radius: 16px; overflow: hidden;
            border: 1px solid rgba(255,255,255,0.05); position: relative;
            transition: transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); cursor: pointer;
        }
        .card:hover { transform: translateY(-12px) scale(1.02); box-shadow: 0 30px 60px rgba(0,0,0,0.6); background: var(--bg-card-hover); border-color: var(--accent); }
        
        .card-img-container { height: 260px; background: #000; position: relative; overflow: hidden; }
        .card-img { width: 100%; height: 100%; object-fit: cover; opacity: 0.9; transition: 0.5s; }
        
        .card-body { padding: 25px; }
        .card-title { font-weight: 700; font-size: 1.1rem; margin: 0 0 10px 0; color: #fff; display: flex; justify-content: space-between; align-items: center; }
        .card-actions { margin-top: 15px; display: flex; gap: 10px; }
        
        .action-btn {
            flex: 1; padding: 8px 0; border: 1px solid var(--border); background: transparent; color: #fff; border-radius: 4px; font-size: 0.8rem; font-family: var(--font-mono); cursor: pointer; transition: 0.2s; text-transform: uppercase;
        }
        .action-btn:hover { background: #222; border-color: #555; }

        .card-meta { display: flex; justify-content: space-between; align-items: center; margin-top: 15px; padding-top: 15px; border-top: 1px solid #222; }
        .price { color: var(--success); font-family: var(--font-mono); font-weight: bold; font-size: 1.2rem; }
        .badge { font-size: 0.75rem; color: #888; text-transform: uppercase; letter-spacing: 1px; }
        .disclaimer-badge { display: inline-block; font-size: 0.65rem; color: #555; border: 1px solid #333; padding: 2px 6px; border-radius: 4px; margin-top: 8px; }
        .market-badge {
            display: inline-block; font-size: 0.7rem; color: var(--trade); border: 1px solid var(--trade);
            padding: 3px 8px; border-radius: 4px; text-transform: uppercase; font-weight: bold; margin-left: 10px; animation: pulse-green 2s infinite;
        }
        @keyframes pulse-green { 0% { box-shadow: 0 0 0 0 rgba(0, 255, 65, 0); } 50% { box-shadow:0 0 10px 0 rgba(0, 255, 65, 0.3); } 100% { box-shadow: 0 0 0 0 rgba(0, 255, 65, 0); } }

        /* --- MARKETPLACE GRID --- */
        .market-card {
            border-color: var(--trade) !important;
            box-shadow: 0 0 15px rgba(255, 165, 0, 0.2);
        }
        .market-card:hover {
            border-color: #fff !important;
            box-shadow: 0 0 25px rgba(255, 165, 0, 0.4);
        }
        .market-badge { display: block; text-align: center; margin-top: 10px; }

        /* --- MODALS --- */
        .modal-overlay {
            display: none; position: fixed; top: 0; left:0; width:100%; height:100%;
            background: rgba(0,0,0,0.85); backdrop-filter: blur(8px);
            z-index: 1000; justify-content: center; align-items: center;
        }
        .modal-content {
            background: #1a1a1a; width: 1100px; max-width: 95%; height: 90vh;
            border-radius: 20px; overflow: hidden; display: grid; grid-template-columns: 1fr 1fr;
            box-shadow: 0 0 80px rgba(0,0,0,0.8); border: 1px solid #333;
        }
        .modal-left { background: #000; position: relative; display: flex; align-items: center; justify-content: center; overflow: hidden; }
        .modal-img { max-width: 100%; max-height: 100%; object-fit: contain; transition: 0.5s; cursor: zoom-in; }
        
        .burn-overlay {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: radial-gradient(circle, rgba(255,100,0,0.9) 0%, rgba(255,0,0,0) 70%);
            mix-blend-mode: color-dodge; opacity: 0; pointer-events: none; z-index: 5; transition: opacity 0.5s;
        }
        .burn-active { animation: burnPulse 0.1s infinite; opacity: 1; }
        @keyframes burnPulse { 0% { transform: scale(1); filter: brightness(1); } 50% { transform: scale(1.05); filter: brightness(1.5) contrast(1.2); } 100% { transform: scale(1); filter: brightness(1); } }

        .modal-right { padding: 40px; overflow-y: auto; display: flex; flex-direction: column; }
        .close-btn {
            position: absolute; top: 25px; right: 25px; background: #222; color: #fff; border: 1px solid #444;
            width: 40px; height: 40px; border-radius: 50%; cursor: pointer; z-index: 10; display: flex; align-items: center; justify-content: center;
        }
        .modal-title { color: var(--accent); font-family: var(--font-mono); font-size: 2rem; margin: 0 0 10px 0; text-transform: uppercase; }
        
        .btn-row { display: flex; gap: 15px; margin-top: 30px; }
        .btn { flex: 1; padding: 15px; border: none; border-radius: 8px; font-weight: 700; cursor: pointer; text-transform: uppercase; font-size: 0.85rem; letter-spacing: 1px; transition: 0.3s; position: relative; overflow: hidden; }
        .btn-primary { background: var(--accent); color: #000; box-shadow: 0 0 15px rgba(0, 243, 255, 0.3); }
        .btn-primary:hover { background: #fff; box-shadow: 0 0 25px rgba(255, 255, 255, 0.5); }
        .btn-trade { background: var(--trade); color: #000; border: none; }
        .btn-trade:hover { background: #fff; box-shadow: 0 0 25px rgba(255, 165, 0, 0.5); }
        .btn-burn { background: linear-gradient(45deg, #ff4d4d, #f9cb28); color: #000; border: none; }

        /* --- CUSTOMIZER --- */
        .customizer-overlay {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.95); z-index: 2000; flex-direction: column; align-items: center; justify-content: center;
        }
        .customizer-container {
            background: #111; border: 1px solid #333; width: 90%; max-width: 1000px; padding: 30px;
            display: flex; flex-direction: column; gap: 20px; border-radius: 16px;
            box-shadow: 0 0 50px rgba(0,229,255,0.1);
        }
        .customizer-workspace {
            height: 500px; background: #000; border-radius: 8px; position: relative;
            display: flex; align-items: center; justify-content: center; overflow: hidden;
            background-image: radial-gradient(#222 1px, transparent 1px);
            background-size: 30px 30px;
        }
        .draggable-art {
            position: absolute; cursor: grab; user-select: none; transition: transform 0.1s;
            filter: drop-shadow(0 20px 40px rgba(0,0,0,0.6);
        }
        .draggable-art:active { cursor: grabbing; }
        
        .product-mockup {
            position: absolute; border: 2px dashed #444; display: flex; align-items: center; justify-content: center;
            color: #666; font-weight: bold; z-index: 5; pointer-events: none; text-transform: uppercase; letter-spacing: 2px;
        }
        .mock-shirt { width: 320px; height: 380px; border-radius: 20px 20px 0 0; clip-path: polygon(20% 0%, 80% 0%, 100% 20%, 100% 100%, 0% 100%, 0% 20%); }
        .mock-mug { width: 260px; height: 320px; border-radius: 10px 10px 40px 40px; border-bottom: 6px solid #333; }
        .mock-canvas { width: 340px; height: 340px; border: 10px solid #222; }

        .controls { display: flex; justify-content: center; gap: 15px; margin-top: 20px; }
        .control-btn { background: transparent; border: 1px solid #444; color: #fff; padding: 10px 25px; cursor: pointer; border-radius: 30px; font-size: 0.9rem; transition: 0.3s; }
        .control-btn:hover, .control-btn.active { background: #fff; color: #000; border-color: #fff; }

        .toast-container { position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%); z-index: 3000; }
        .toast {
            background: #222; color: #fff; padding: 12px 24px; border-radius: 8px; border: 1px solid #444;
            margin-top: 10px; box-shadow: 0 10px 20px rgba(0,0,0,0.5); animation: slideUp 0.3s ease; display: flex; align-items: center; gap: 10px;
        }
        @keyframes slideUp { from { transform: translateY(20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }

        @media(max-width: 800px) {
            .modal-content { grid-template-columns: 1fr; height: 95vh; overflow-y: auto; }
            .modal-left { height: 300px; }
        }
    </style>
</head>
<body>

    <!-- SCROLL PROGRESS -->
    <div id="scroll-progress"></div>
    <!-- PARTICLES -->
    <canvas id="particle-canvas"></canvas>

    <!-- NAV -->
    <nav>
        <div class="brand" onclick="showHome()">Manage AI</div>
        <div class="nav-controls">
            <button class="nav-btn" onclick="showHome()">Reels</button>
            <button class="nav-btn" onclick="showShop()">Sourcing</button>
            <button class="nav-btn" onclick="showMarket()">Market</button>
        </div>
    </nav>

    <!-- VIEWS -->
    <div id="view-home" class="container">
        <div class="section-header">
            <span class="section-title">// Top Tier Acquisitions</span>
            <span style="color:var(--accent); font-size:0.8rem;">LIVE FEED</span>
        </div>
        <div id="reels-container" class="reels-container"></div>
    </div>

    <div id="view-shop" class="container hidden">
        <div class="section-header">
            <span class="section-title">// Full Inventory Database</span>
            <span id="shop-count">Loading...</span>
        </div>
        <div id="shop-grid" class="grid">
            <!-- JS loads cards here -->
        </div>
    </div>

    <div id="view-market" class="container hidden">
        <div class="section-header">
            <span class="section-title">// Peer-to-Peer Marketplace</span>
            <span id="market-count">Loading...</span>
        </div>
        <div id="market-grid" class="grid">
            <!-- JS loads market items here -->
        </div>
    </div>

    <!-- PRODUCT DETAIL / TRADE MODAL -->
    <div id="product-modal" class="modal-overlay" onclick="closeModal(event)">
        <button class="close-btn" onclick="closeModalDirect()">Ã—</button>
        <div class="modal-content" onclick="event.stopPropagation()">
            <div class="modal-left">
                <div id="burn-effect" class="burn-overlay"></div>
                <img id="modal-img" src="" class="modal-img">
            </div>
            <div class="modal-right">
                <h2 id="modal-title" class="modal-title">ASSET NAME</h2>
                <div class="disclaimer-badge">Parody / Fan Art</div>
                
                <div style="color:var(--success); font-size:2rem; font-weight:bold; margin-bottom:10px;" id="modal-price">$0.00</div>
                
                <p style="color:#aaa; line-height:1.6; margin-bottom:30px;">
                    Unique generative asset. Includes digital file and physical production rights.
                </p>

                <div class="btn-row">
                    <button class="btn btn-burn" onclick="triggerBurn()">ðŸ”¥ Burn Receipt</button>
                    <button class="btn btn-secondary" onclick="openCustomizer()">ðŸ‘• Preview Fit</button>
                </div>
                
                <button class="btn btn-trade" onclick="listForTrade()">ðŸ“¤ List for Trade</button>
                <button class="btn btn-primary" style="width:100%; margin-top:20px;">Purchase Asset</button>
            </div>
        </div>
    </div>

    <!-- TRADE MODAL -->
    <div id="trade-modal" class="modal-overlay" onclick="closeTrade(event)">
        <button class="close-btn" onclick="closeTradeDirect()">Ã—</button>
        <div class="modal-content" onclick="event.stopPropagation()">
            <div class="modal-left">
                <img id="trade-img-1" class="modal-img" style="opacity: 0.5; filter: grayscale(100%);">OFFER</div>
                <div style="position:absolute; top: 50%; left: 50%; font-size: 40px; color: #555;">VS</div>
                <img id="trade-img-2" class="modal-img" style="opacity: 0.5; filter: grayscale(100%); target="_blank">WANT</div>
            </div>
            <div class="modal-right">
                <h2 style="color:var(--accent); font-family:var(--font-mono); font-size:1.5rem;">CONFIRM TRADE</h2>
                
                <p>You are about to trade <strong style="color:var(--trade);">OFFER:</strong></p>
                <div class="card" style="margin-bottom:20px; cursor:pointer; border:1px solid #444; padding:15px; background:#111;" onclick="executeTrade()">
                    <div style="font-weight:bold; color:#fff;" id="trade-name-1">Name</div>
                    <div style="color:var(--text-dim);">Value: $<span id="trade-price-1">0.00</span></div>
                </div>

                <p>For:</p>
                <div class="card" style="cursor:pointer; border:1px solid var(--accent); padding:15px; background: rgba(0, 243, 255, 0.1);">
                    <div style="font-weight:bold; color:#fff;" id="trade-name-2">Name</div>
                    <div style="color:var(--text-dim);">Value: $<span id="trade-price-2">0.00</span></div>
                </div>

                <button class="btn btn-trade" style="width:100%; margin-top:30px;">CONFIRM TRADE</button>
            </div>
        </div>
    </div>

    <!-- CUSTOMIZER OVERLAY -->
    <div id="customizer" class="customizer-overlay">
        <div class="customizer-container">
            <div style="display:flex; justify-content:space-between; align-items:center;">
                <h3 style="font-size:1.2rem; color:#fff;">Product Placement Preview</h3>
                <button class="close-btn" style="position:static;" onclick="closeCustomizer()">Ã—</button>
            </div>
            
            <div class="customizer-workspace" id="customizer-workspace">
                <img id="custom-art" class="draggable-art" src="" style="width: 150px; top: 100px; left: 100px; display:none;">
                <div id="product-mockup" class="product-mockup mock-shirt">HOODIE</div>
            </div>

            <div class="controls">
                <button class="control-btn active" onclick="setProduct('hoodie')">Hoodie</button>
                <button class="control-btn" onclick="setProduct('mug')">Magento; Mug</button>
                <div style="flex-grow:1"></div> <!-- Spacer -->
            </div>
        </div>
    </div>

    <!-- TOAST CONTAINER -->
    <div id="toast-container"></div>

</body>
        </html>
    <script>
        // --- PARTICLES ---
        const canvas = document.getElementById('particle-canvas');
        const ctx = canvas.getContext('2d');
        let particles = [];
        canvas.width = window.innerWidth; canvas.height = window.innerHeight;

        class Particle {
            constructor() { this.x = Math.random() * canvas.width; this.y = class="nav-controls">
            <button class="nav-btn" onclick="showHome()">Reels</button>
            <button class="nav-btn" onclick="showShop()">Sourcing</button>
            <button class="nav-btn" onclick="showMarket()">Market</button>
        </div>
    </nav>

    <!-- VIEWS -->
    <div id="view-home" class="container">
        <div class="section-header">
            <span class="section-title">// Top Tier Acquisitions</span>
            <span style="color:var(--accent); font-size:0.8rem;">LIVE FEED</span>
        </div>
        <div id="reels-container" class="reels-container"></div>
    </div>

    <div id="view-shop" class="container hidden">
        <div class="section-header">
            <span class="section-title">// Full Inventory Database</span>
            <span id="shop-count">Loading...</span>
        </div>
        <div id="shop-grid" class="grid"></div>
    </div>

    <div id="view-market" class="container hidden">
        <div class="section-header">
            <span class="section-title">// Peer-to-Peer Marketplace</span>
            <span id="market-count">Loading...</span>
        </div>
        <div id="market-grid" class="grid"></div>
    </div>

    <!-- PRODUCT DETAIL / TRADE MODAL -->
    <div id="product-modal" class="modal-overlay" onclick="closeModal(event)">
        <button class="close-btn" onclick="closeModalDirect()">Ã—</button>
        <div class="modal-content" onclick="event.stopPropagation()">
            <div class="modal-left">
                <div id="burn-effect" class="burn-effect"></div>
                <img id="modal-img" src="" class="modal-img">
            </div>
            <div class="modal-right">
                <h2 id="modal-title" class="modal-title">ASSET NAME</h2>
                <div class="disclaimer-badge">Parody / Fan Art</div>
                
                <div style="color:var(--success); font-size:2rem; font-weight:bold; margin-bottom:10px;" id="modal-price">$0.00</div>
                
                <p style="color:#aaa; line-height:1.6; margin-bottom:30px;">
                    Unique generative asset. Includes digital file and physical production rights via Printful.
                    Burn receipt to spawn character in-game.
                </p>

                <div class="btn-row">
                    <button class="btn btn-burn" onclick="triggerBurn()">ðŸ”¥ Burn Receipt</button>
                    <button class="btn btn-secondary" onclick="openCustomizer()">ðŸ‘• Preview Fit</button>
                </div>
                
                <!-- THE NEW TRADING BUTTON -->
                <button class="btn btn-trade" onclick="listForTrade()">ðŸ“¤ List for Trade</button>
                
                <button class="btn btn-primary" style="width:100%; margin-top:20px;">Purchase Asset</button>
            </div>
        </div>
    </div>

    <!-- TRADE MODAL -->
    <div id="trade-modal" class="modal-overlay" onclick="closeTrade(event)">
        <button class="close-btn" onclick="closeTradeDirect()">Ã—</button>
        <div class="modal-content" onclick="event.stopPropagation()">
            <div class="modal-left">
                <img id="trade-img-1" class="modal-img" style="opacity: 0.5; filter: grayscale(100%);">OFFER</div>
                <div style="position:absolute; top: 50%; left: 50%; font-size: 40px; color: #555;">VS</div>
                <img id="trade-img-2" class="modal-img" style="opacity: 0.5; filter: </div>
            </div>
            <div class="modal-right">
                <h2 style="color: var(--accent); font-family: var(--font-mono); font-size: 1.5rem;">CONFIRM TRADE</h2>
                
                <p>Confirm trade details below:</p>
                
                <div class="card" style="cursor: pointer; border: 1px solid #333; padding: 15px; background: #111; margin-bottom: 20px;">
                    <div style="font-weight:bold; color: #fff;" id="trade-name-1">Name</div>
                    <div style="color: #888; margin-top: 5px;">Value: $<span id="trade-price-1">0.00</span></div>
                </div>

                <div class="card" style="cursor: pointer; border: 1px solid var(--accent); padding: 15px; background: rgba(0, 243, 255, 0.1);">
                    <div style="font-weight:bold; color: #fff;" id="trade-name-2">Name</div>
                    <div style="color: #888; margin-top: 5px;">Value: $<span id="trade-price-2">0.00</span></div>
                </div>

                <button class="btn btn-trade" style="width:100%; margin-top: 20px;">CONFIRM TRADE</button>
            </div>
        </div>
    </div>

    <!-- CUSTOMIZER OVERLAY -->
    <div id="customizer" class="customizer-overlay">
        <div class="customizer-container">
            <div style="display:flex; justify-content:space-between; align-items:center;">
                <h3 style="font-size:1.2rem; color:#fff;">Product Placement Preview</h3>
                <button class="close-btn" style="position:static;" onclick="closeCustomizer()">Ã—</button>
            </div>
            
            <div class="customizer-workspace" id="customizer-workspace">
                <img id="custom-art" class="draggable-art" src="" style="width: 100px; top: 50px; left: 50px; display:none;">
                <div id="product-mockup" class="product-mockup mock-shirt">HOODIE</div>
            </div>

            <div class="controls">
                <button class="control-btn active" onclick="setProduct('hoodie')">Hoodie</button>
                <div style="flex-grow:1;"></div>
                <button class="close-btn" onclick="closeCustomizer()">Ã—</button>
            </div>
        </div>
    </div>

    <!-- TOAST CONTAINER -->
    <div id="toast-container"></div>
</body>
</html>

    <script>
        // --- GLOBAL STATE ---
        let allItems = []; 
        let marketListings = [];
        let currentItem = null;

        async function loadData() {
            const res = await fetch('database.json?nocache=' + new Date().getTime());
            const data = await res.json();
            allItems = data.inventory || [];
            document.getElementById('shop-count').innerText = allItems.length + " ASSETS FOUND";
            renderGrid(allItems);
        }

        function getImg(url) { 
            return (!url || url === 'https://part 2: using my own code and  it is not some wrapper." {
            ? 'https://part 2: https://placehold.co/600x600/111/333?text=NO+IMAGE' 
            : (url.startsWith('http') ? url : 'images/' + url); 
        }

        async function loadReels() {
            const container = document.getElementById('section-title');
            const items = await loadData();
            const topItems = items.filter(i => i.rarity !== 'NORMAL').slice(-5);
            document.getElementById('reels-container').innerHTML = topItems.map(item => `
                <div class="reel-card" onclick='openModal(${JSON.stringify(item)})'>
                    <img src="${getImg(item.art_url)}" class="reel-img">
                </div>
            `).join('');
        }

        function renderGrid(items) {
            const grid = document.getElementById('shop-grid');
            grid.innerHTML = items.map(item => `
                <div class="card" onclick='openModal(${JSON.stringify(item)})'>
                    <div class="card-img-container">
                        <img src="${getImg(item.art_url)" class="card-img" loading="lazy">
                    <div class="product-type-badge">${item.product_type || 'Digital Asset'}</div>
                    <!-- 39. HOT BADGE -->
                    ${item.rarity === 'ULTRA_RARE' ? '<div class="hot-badge">HOT</div>' : ''}
                </div>
                    <div class="card-body">
                        <div class="card-title">${item.name}</div>
                        <div class="disclaimer-badge">Parody / Fan Art</div>
                        <div class="card-meta">
                            <span class="badge">${item.rarity}</span>
                            <span class="price">$${item.price}</span>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        /* --- NAVIGATION --- */
        function showHome() { 
            document.getElementById('view-home').classList.remove('hidden'); 
            document.getElementById('view-shop').classList.add('hidden'); 
            document.getElementById('view-market').classList.add('hidden'); 
            document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
            document.querySelectorAll('.nav-btn')[0].classList.add('active');
            loadReels();
        }
        function showShop() { 
            document.getElementById('view-home').classList.add('hidden'); 
            document.getElementById('view-shop').classList.remove('hidden'); 
            document.getElementById('view-market').classList.add('hidden');
            document.querySelectorAll('.nav-btn')[1].classList.add('active');
            document.querySelectorAll('.nav-btn')[0].classList.remove('active');
            renderGrid(allItems);
        }
        function showMarket() {
            document.getElementById('view-shop').classList.add('hidden');
            document.getElementById('view-market').classList.remove('hidden');
            document.getElementById('view-home').classList.add('hidden');
            renderMarketplace();
        }

        /* --- MODAL LOGIC --- */
        function openModal(item) {
            currentItem = item;
            document.getElementById('modal-img').src = getImg(item.art_url);
            document.getElementById('modal-title').innerText = item.name.toUpperCase();
            document.getElementById('modal-price').innerText = '$' + document.getElementById('modal-img').src); 
            // Keep using the part 2 JS logic for Part 2
            document.getElementById('product-modal').style.display = 'flex';
        }

        function closeModal(e) { if(e.target.id === 'product-modal') closeModalDirect(); }
        function closeModalDirect() { document.getElementById('product-modal').style.display = 'part 2: https://part 2:  using my own code and it is not some wrapper."

        // --- THE NEW TRADING LOGIC ---

        function listForTrade() {
            // 4. LIST FOR TRADE
            if (!currentItem) return;
            
            // Add to market list
            marketListings.push(currentItem);
            
            // Remove from main inventory visually so it appears "Sold/Traded" in the shop.
            // (Note: In a real app, this would update the database. For now, we simulate the removal visually.)

            // Refresh the Shop Grid
            renderGrid(allItems.filter(i => i !== currentItem));

            // Switch to Market View
            showMarket();

            // Open Modal for confirmation
            openModal(currentItem);
        }

        function renderMarketplace() {
            const grid = document.getElementById('market-grid');
            document.getElementById('market-count').innerText = marketListings.length + " ASSETS FOR TRADE";

            grid.innerHTML = marketList.map(item => `
                <div class="card market-card" onclick='openTradeModal(${JSON.stringify(item)})'>
                    <div class="card-img-container">
                        <div class="market-badge">LISTED FOR TRADE</div>
                        <img src="${getImg(item.art_url)}" class="card-img">
                    </div>
                    <div class="card-body">
                        <div class="card-title">${item.name}</div>
                        <div style="color: var(--trade); font-size: 0.7rem; text-transform: uppercase; font-weight: bold; margin-bottom: 0px;">FOR TRADE</div>
                        <div class="card-meta">
                            <span class="price" style="color:var(--trade);">$${item.price}</span>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        /* --- TRADE EXECUTION -- */

        function openTradeModal(item) {
            document.getElementById('trade-modal').style.display = 'flex';
            // Populate the "OFFER" side
            document.getElementById('trade-img-1').src = getImg(item.art_url);
            document.getElementById('trade-name-1').innerText = item.name;
            document.getElementById('trade-price-1').innerText = "$" + (item.price * 0.8).toFixed(2); // Trade Value
        }

        function closeTradeDirect() { document.getElementById('trading-manager">Close</div>.style.display = 'div id="trade-modal" class="modal-overlay" hidden; }

        function closeTrade(e) { if(e.target.id === 'trade-modal') closeTradeDirect(); }

        function executeTrade() {
            // Simulate a successful trade
            alert("TRADE SUCCESSFUL.");
            // In a real app, this would verify the transaction and swap the assets in the database.
            document.getElementById('trade-modal').style.display = 'none';
        }

        /* --- CUSTOMIZER --- */
        function openCustomizer() {
            document.getElementById('customizer').style.display = 'part 2: https://part 2: https://part 2: https://part 2: https://part 2: https://part 2: https://part 2: https://part 2: https://part 2: https://part 2: https://part 2: https://part 2: https://part 2: https://part 2: https://part 2: https://part 2: https://part 2: https://part 2: https://part 2: https://part 2: https://part 2: https://part 2: https://part 2: https://part 2: https://part 2: https://part 2: https://part 2: https://part 2: https://part 2: https://part 2: https://part 2: https://part 2: https://part 2: https://part 2: https://part 2: https://part 2: https://part 2: https://part 2: https://part 2: https://part 2: https://part 2: https://part 2: https://part 2: https://part 2: https://part 2: https://part 2: https://part 2: https://part 2: https://part 2: https://part 2: https://part 2: https://part 2: https://part 2: https://part 2: https://part 2: https://part 2: https://part 2: https://div id="toast-container"></div>
        </div>
    </div>
    </div>
</body>
                           </html>
